<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sc="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title th:text="${title}"></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" th:href="@{/css/movieslist.css}">
</head>
<body>

<header th:insert="fragments :: nav"></header>
<main role="main">
    <div class="album py-5">
        <div class="container" >
            <div class="row">
                <div class="col-md-4" th:each="movie: ${movies}"
                     th:object="${movie}">
                    <div id="card">
                        <a  th:href="@{/movies/detail/{id}(id=*{id})}" style="text-decoration: none;color: inherit;">
                            <div class="card mb-4 shadow p-3 mb-5 bg-body rounded">
                                <img class="card-img-top" th:src="|${urlImage}${movie.backdrop_path}|"
                                     alt="Imagen no disponible">
                                <div class="card-body">
                                    <h5 class="card-title" th:text="*{title}"></h5>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item disabled"
                                                th:text="'Fecha de estreno: '+ *{release_date}"></li>
                                            <li class="list-group-item disabled">
                                                <span th:each="a, g : *{genres}" th:text="${!g.last} ? ${a.name} + ',': ${a.name}"></span>&nbsp;
                                            </li>
                                            <li class="list-group-item">
                                                <span class="text-secondary">Puntuación:</span>
                                                <span class="badge circle circle-md text-white gradient-custom-5 mr-2" th:text="*{vote_average}"></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-8">
                        <nav aria-label="Pagination" class="hidden-xs">
                            <ul class="pagination justify-content-center">
                                <li class="page-item"
                                    th:classappend="@{prevPage == 0 ? 'disabled' : ''}">
                                    <a class="page-link text-secondary  "
                                       th:href="@{'/movies/page/' + ${prevPage}}"
                                       th:text="Anterior"></a>
                                </li>
                                <li class="page-item"
                                    th:each="i: ${#numbers.sequence(totalItems + 1, totalPages > 10 + totalItems ? totalItems + 10 : totalPages, 1 )}"
                                    th:classappend="${currentPage == i ? 'active' : ''} ">
                                    <a class="page-link" th:href="@{'/movies/page/' + ${i}}"
                                       th:text="${i}"></a>

                                </li>
                                <li class="page-item" th:classappend="@{current == totalPages ? 'disabled' : ''}">
                                    <a class="page-link text-secondary"
                                       th:href="@{'/movies/page/' + ${nextPage}}" th:text="Siguiente">
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
            <p th:text="'Total Películas ' + ${totalItems} +' : '+ 'Página'+ ${currentPage}+' de '+ ${totalPages}"></p>
        </div>
    </div>
</main>

<footer th:insert="fragments :: footer"></footer>
<div th:insert="fragments :: scripts"></div>
</body>
</html>